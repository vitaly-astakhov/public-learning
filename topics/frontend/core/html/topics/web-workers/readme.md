# Web workers

## Materials

- [Web workers [HTML spec]](https://html.spec.whatwg.org/multipage/workers.html#workers)
- [Service Workers [W3C spec]](https://w3c.github.io/ServiceWorker)

## Libraries

- [comlink](https://github.com/GoogleChromeLabs/comlink)

## Table of contents

- [Overview](#overview)
- [Dedicated workers](#dedicated-workers)
- [Shared workers](#shared-workers)
- [Service worker](#service-worker)

## Overview

Web Workers API –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –ª—é–±—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞.

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –¥–ª–∏—Ç–µ–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞—é—â–∏–µ —Å–∫—Ä–∏–ø—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞—é—Ç—Å—è —Å–∫—Ä–∏–ø—Ç–∞–º–∏, —Ä–µ–∞–≥–∏—Ä—É—é—â–∏–º–∏ –Ω–∞ –∫–ª–∏–∫–∏ –∏–ª–∏ –¥—Ä—É–≥–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –¥–ª–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏, –Ω–µ —Å–Ω–∏–∂–∞—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã.

–†–∞–±–æ—á–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã (*workers*) (—Ç–∞–∫ –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è —ç—Ç–∏ —Ñ–æ–Ω–æ–≤—ã–µ —Å–∫—Ä–∏–ø—Ç—ã) –∏–º–µ—é—Ç –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –±–æ–ª—å—à–æ–π –≤–µ—Å –∏ –Ω–µ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ. –ù–∞–ø—Ä–∏–º–µ—Ä, –±—ã–ª–æ –±—ã –Ω–µ—É–º–µ—Å—Ç–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –æ–¥–Ω—É —Ä–∞–±–æ—á—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É (*worker*) –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–∏–∫—Å–µ–ª—è —á–µ—Ç—ã—Ä–µ—Ö–º–µ–≥–∞–ø–∏–∫—Å–µ–ª—å–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.

–ö–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –æ–∂–∏–¥–∞–µ—Ç—Å—è, —á—Ç–æ —Ä–∞–±–æ—á–∏–µ —Å–∏—Å—Ç–µ–º—ã –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –¥–æ–ª–≥–æ (*long-lived*), –±—É–¥—É—Ç –∏–º–µ—Ç—å –≤—ã—Å–æ–∫—É—é –Ω–∞—á–∞–ª—å–Ω—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (*start-up performance cost*) –∏ –≤—ã—Å–æ–∫—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø–∞–º—è—Ç–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ (*per-instance memory cost*).

–ö–∞–∂–¥–∞—è —Ä–∞–±–æ—á–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ (*worker*) –∏–º–µ–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—É—é –æ–±–ª–∞—Å—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä–∞—è —è–≤–ª—è–µ—Ç—Å—è –µ–≥–æ "–≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —á–∞—Å—Ç—å—é", –∫–æ—Ç–æ—Ä–∞—è –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º [`WorkerGlobalScope`](https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope). [`WorkerGlobalScope`](https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope) —Å–ª—É–∂–∏—Ç –±–∞–∑–æ–≤—ã–º –∫–ª–∞—Å—Å–æ–º –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Ç–∏–ø–æ–≤ –æ–±—ä–µ–∫—Ç–æ–≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏ worker, –≤–∫–ª—é—á–∞—è [`DedicatedWorkerGlobalScope`](https://html.spec.whatwg.org/multipage/workers.html#dedicatedworkerglobalscope),¬†[`SharedWorkerGlobalScope`](https://html.spec.whatwg.org/multipage/workers.html#sharedworkerglobalscope), –∏[`ServiceWorkerGlobalScope`](https://w3c.github.io/ServiceWorker/#serviceworkerglobalscope).

–£ —Ä–∞–±–æ—á–∏—Ö –ø—Ä–æ–≥—Ä–∞–º–º (*worker*), —Ç–∞–∫–∏—Ö –∫–∞–∫ [dedicated worker agent](https://html.spec.whatwg.org/multipage/webappapis.html#dedicated-worker-agent),¬†[shared worker agent](https://html.spec.whatwg.org/multipage/webappapis.html#shared-worker-agent), –∏–ª–∏ [service worker agent](https://html.spec.whatwg.org/multipage/webappapis.html#service-worker-agent) –µ—Å—Ç—å —Ü–∏–∫–ª —Å–æ–±—ã—Ç–∏–π (*event loop*), –∫–æ—Ç–æ—Ä—ã–π –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è [worker event loop](https://html.spec.whatwg.org/multipage/webappapis.html#worker-event-loop-2) –∏ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∑–∞–¥–∞—á –≤ –∫–æ—Ç–æ—Ä–æ–º –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å–æ–±—ã—Ç–∏—è, –æ–±—Ä–∞—Ç–Ω—ã–µ –≤—ã–∑–æ–≤—ã –∏ —Å–µ—Ç–µ–≤–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å. –≠—Ç–∏ worker event loop —Å–æ–∑–¥–∞—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –∑–∞–ø—É—Å–∫–∞ —Ä–∞–±–æ—á–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ ([*run a worker*](https://html.spec.whatwg.org/multipage/workers.html#run-a-worker)).

## [Dedicated workers](https://html.spec.whatwg.org/multipage/workers.html#worker)

–í—ã–¥–µ–ª–µ–Ω–Ω—ã–µ —Ä–∞–±–æ—á–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã (*dedicated worker*) –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–∏–≤—è–∑—ã–≤–∞—é—Ç—Å—è –∫ —Å–≤–æ–µ–º—É —Å–æ–∑–¥–∞—Ç–µ–ª—é, –Ω–æ –ø–æ—Ä—Ç—ã —Å–æ–æ–±—â–µ–Ω–∏–π –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è —Å–≤—è–∑–∏ –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–π —Ä–∞–±–æ—á–µ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã (*dedicated worker*) —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –¥—Ä—É–≥–∏–º–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞–º–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏–ª–∏ —Ä–∞–±–æ—á–∏–º–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞–º–∏ (*dedicated worker*) .

–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ä–∞–±–æ—á–µ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã (*worker*) —Ç—Ä–µ–±—É–µ—Ç—Å—è URL-–∞–¥—Ä–µ—Å —Ñ–∞–π–ª–∞ JavaScript. –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä [`Worker()`](https://html.spec.whatwg.org/multipage/workers.html#dom-worker) –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Å URL-–∞–¥—Ä–µ—Å–æ–º —ç—Ç–æ–≥–æ —Ñ–∞–π–ª–∞ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞.

–í—ã–¥–µ–ª–µ–Ω–Ω—ã–µ —Ä–∞–±–æ—á–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã (*dedicated workers*) –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–±—ä–µ–∫—Ç—ã [`MessagePort`](https://html.spec.whatwg.org/multipage/web-messaging.html#messageport) –∑–∞ –∫—É–ª–∏—Å–∞–º–∏ –∏, —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –≤—Å–µ —Ç–µ –∂–µ —Ñ—É–Ω–∫—Ü–∏–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –ø–µ—Ä–µ–¥–∞—á–∞ –¥–≤–æ–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –ø–µ—Ä–µ–¥–∞—á–∞ –¥—Ä—É–≥–∏—Ö –ø–æ—Ä—Ç–æ–≤.

> [!NOTE]
> –£ –Ω–µ—è–≤–Ω–æ–≥–æ (implicit) [`MessagePort`](https://html.spec.whatwg.org/multipage/web-messaging.html#messageport), –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–º–∏ —Ä–∞–±–æ—á–∏–º–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞–º–∏ (*dedicated workers*), –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–µ—è–≤–Ω–æ (*implicitly*) –≤–∫–ª—é—á–µ–Ω–∞ –æ—á–µ—Ä–µ–¥—å —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–∞ –ø–æ—Ä—Ç ([*port message queue*](https://html.spec.whatwg.org/multipage/web-messaging.html#port-message-queue)), –ø–æ—ç—Ç–æ–º—É –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ [`Worker`](https://html.spec.whatwg.org/multipage/workers.html#worker) –Ω–µ—Ç —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–∞ –º–µ—Ç–æ–¥—É `start()` –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ [`MessagePort`](https://html.spec.whatwg.org/multipage/web-messaging.html#messageport).

## [Shared workers](https://html.spec.whatwg.org/multipage/workers.html#sharedworker)

–†–∞–∑–¥–µ–ª—è–µ–º—ã–µ —Ä–∞–±–æ—á–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã (*shared workers*) –∏–º–µ—é—Ç –∏–º–µ–Ω–∞, –∏ –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –ª—é–±–æ–π —Å–∫—Ä–∏–ø—Ç, –∑–∞–ø—É—â–µ–Ω–Ω—ã–π –≤ —Ç–æ–º –∂–µ –∏—Å—Ç–æ—á–Ω–∏–∫–µ, –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ —ç—Ç—É —Ä–∞–±–æ—á—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É (*worker*) –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å –Ω–∏–º.

–†–∞–∑–¥–µ–ª—è–µ–º—ã–µ —Ä–∞–±–æ—á–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã (*shared workers*) –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É—é—Ç—Å—è –ø–æ URL-–∞–¥—Ä–µ—Å—É —Å–∫—Ä–∏–ø—Ç–∞, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–ª—è –µ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è, –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å —è–≤–Ω—ã–º (*explicit*) –∏–º–µ–Ω–µ–º. –ò–º—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –æ–±—â–µ–≥–æ —Ä–∞–±–æ—á–µ–≥–æ –æ–±—ä–µ–∫—Ç–∞.

–†–∞–∑–¥–µ–ª—è–µ–º—ã–µ —Ä–∞–±–æ—á–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã (*shared workers*) –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫—É ([*origin*](https://html.spec.whatwg.org/multipage/browsers.html#concept-origin)). –î–≤–∞ —Ä–∞–∑–Ω—ã—Ö —Å–∞–π—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏—Ö –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –∏–º–µ–Ω–∞, –Ω–µ –±—É–¥—É—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞—Ç—å. –û–¥–Ω–∞–∫–æ, –µ—Å–ª–∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–ø—ã—Ç–∞–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ –∂–µ –∏–º—è —Ä–∞–∑–¥–µ–ª—è–µ–º–æ–π —Ä–∞–±–æ—á–µ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã (*shared worker name*), —á—Ç–æ –∏ –¥—Ä—É–≥–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–∞ —Ç–æ–º –∂–µ —Å–∞–π—Ç–µ, –Ω–æ —Å –¥—Ä—É–≥–∏–º URL-–∞–¥—Ä–µ—Å–æ–º —Å–∫—Ä–∏–ø—Ç–∞, —ç—Ç–æ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ —Å–±–æ—é.

–°–æ–∑–¥–∞–Ω–∏–µ —Ä–∞–∑–¥–µ–ª—è–µ–º—ã–µ —Ä–∞–±–æ—á–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã (*shared workers*)–≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞ [`SharedWorker()`](https://html.spec.whatwg.org/multipage/workers.html#dom-sharedworker). –≠—Ç–æ—Ç –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –ø—Ä–∏–Ω–∏–º–∞–µ—Ç URL-–∞–¥—Ä–µ—Å —Å–∫—Ä–∏–ø—Ç–∞ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø–µ—Ä–≤–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –∏ –∏–º—è —Ä–∞–±–æ—á–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞, –µ—Å–ª–∏ —Ç–∞–∫–æ–≤–æ–µ –∏–º–µ–µ—Ç—Å—è, –≤ –∫–∞—á–µ—Å—Ç–≤–µ –≤—Ç–æ—Ä–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞.

–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å —Ä–∞–∑–¥–µ–ª—è–µ–º—ã–º–∏ —Ä–∞–±–æ—á–∏–º–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞–º–∏ (*shared workers*) –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é —è–≤–Ω—ã—Ö (*explicit*) –æ–±—ä–µ–∫—Ç–æ–≤ `[MessagePort](https://html.spec.whatwg.org/multipage/web-messaging.html#messageport)`. –û–±—ä–µ–∫—Ç, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–π –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–º [`SharedWorker()`](https://html.spec.whatwg.org/multipage/workers.html#dom-sharedworker), —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Å—ã–ª–∫—É –Ω–∞ –ø–æ—Ä—Ç –≤ —Å–≤–æ–µ–º –∞—Ç—Ä–∏–±—É—Ç–µ port.

–í–Ω—É—Ç—Ä–∏ —Ä–∞–∑–¥–µ–ª—è–µ–º–æ–π —Ä–∞–±–æ—á–∏–π –ø—Ä–æ–≥—Ä–∞–º–º—ã (*shared worker*) –Ω–æ–≤—ã–µ –∫–ª–∏–µ–Ω—Ç—ã worker-—Å–µ—Ä–≤–µ—Ä–∞ –æ–±—ä—è–≤–ª—è—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é —Å–æ–±—ã—Ç–∏—è [`connect`](https://html.spec.whatwg.org/multipage/indices.html#event-workerglobalscope-connect). –ü–æ—Ä—Ç –¥–ª—è –Ω–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ –∑–∞–¥–∞–µ—Ç—Å—è –∞—Ç—Ä–∏–±—É—Ç–æ–º [`source`](https://html.spec.whatwg.org/multipage/comms.html#dom-messageevent-source) –æ–±—ä–µ–∫—Ç–∞ event.

## [Service worker](https://w3c.github.io/ServiceWorker)

[–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `navigation.serviceWorker` üìÇ](./examples/example-server-send-event.md)
